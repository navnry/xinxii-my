(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/friend/friend"],{"49dc":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}));var i={uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,"33f0"))},uSearch:function(){return n.e("uview-ui/components/u-search/u-search").then(n.bind(null,"c6cd"))},bRefresh:function(){return Promise.all([n.e("common/vendor"),n.e("components/b-refresh/b-refresh")]).then(n.bind(null,"2dba"))},uIcon:function(){return n.e("uview-ui/components/u-icon/u-icon").then(n.bind(null,"47ce"))},uImage:function(){return n.e("uview-ui/components/u-image/u-image").then(n.bind(null,"a31d"))},uSticky:function(){return n.e("uview-ui/components/u-sticky/u-sticky").then(n.bind(null,"52fc"))},uTabs:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-tabs/u-tabs")]).then(n.bind(null,"0abd"))},bFriendItem:function(){return n.e("components/b-friend-item/b-friend-item").then(n.bind(null,"bc20"))},uLoadmore:function(){return n.e("uview-ui/components/u-loadmore/u-loadmore").then(n.bind(null,"319c"))},uActionSheet:function(){return n.e("uview-ui/components/u-action-sheet/u-action-sheet").then(n.bind(null,"f108"))}},o=function(){var t=this,e=t.$createElement;t._self._c},a=[]},"4ae9":function(t,e,n){"use strict";n.r(e);var i=n("9366"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"6e6a":function(t,e,n){"use strict";var i=n("ba54"),o=n.n(i);o.a},"7b64":function(t,e,n){"use strict";(function(t){n("44a1");i(n("66fd"));var e=i(n("ef86"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},9366:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n("6eeb"));o(n("a78c"));function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=u(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,r=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){r=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(r)throw a}}}}function u(t,e){if(t){if("string"===typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var r={mixins:[i.default],data:function(){return{expandList:[],typeList:[],typeCurrent:0,list:[],enable:!0,page:{type:"",pageNo:1,pageSize:6},status:"loadmore",popupShow:!1,sheetList:[{text:"保存图片到本地"},{text:"发送给朋友"},{text:"分享到朋友圈"}],shareContent:{}}},onLoad:function(){this.getList(),this.getTypeList(),this.getExpandList()},computed:{},onShow:function(){this.enable=!0},onHide:function(){this.enable=!1},methods:{toSearch:function(){this.$u.route({url:"pages/base/search",params:{type:"friend"}})},toExpand:function(){this.$u.route({url:"pages/home/friend/expand"})},pullDown:function(t){setTimeout((function(){t.endSuccess()}),1e3)},changeTab:function(t){this.page.type=this.typeList[t].id,this.page.pageNo=1,this.typeCurrent=t,this.list=[],this.getList()},handlerSheet:function(t){this.popupShow=!0,this.shareContent=t,console.log(this.shareContent)},copyContent:function(e){return new Promise((function(n,i){t.setClipboardData({data:e,success:function(t){n(t)},fail:function(t){i(t)},complete:function(){t.hideToast()}})}))},saveImg:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(i,o){var u,s=a(e);try{for(s.s();!(u=s.n()).done;){var r=u.value;n&&t.showLoading({title:"正在保存",mask:!0}),t.downloadFile({url:r,success:function(e){200===e.statusCode&&t.saveImageToPhotosAlbum({filePath:e.tempFilePath,success:function(t){i(),console.log(t)},fail:function(t){console.log(t),o()},complete:function(){t.hideLoading()}})}})}}catch(c){s.e(c)}finally{s.f()}}))},handlerShare:function(e){var n=this;switch(e){case 0:this.saveImg(this.shareContent.picList).then((function(e){t.showToast({icon:"none",title:"图片保存成功"})})).catch((function(e){t.showToast({icon:"none",title:"图片保存失败，请检查系统权限"})}));break;case 1:this.copyContent(this.shareContent.content).then((function(e){""!==e.data?n.$showModal({title:"提示",content:"文字复制成功，去微信粘贴给好友吧"}):t.showToast({icon:"none",title:"文字复制失败"})}));break}},getTypeList:function(){var t=this,e=this.$storage.get("friendTypeList");e?this.typeList=e:this.$api.friendTypeList().then((function(e){e.success&&(e.data.forEach((function(e){e.name=e.value,e.id=e.key,t.$delete(e,"value"),t.$delete(e,"key")})),t.typeList=e.data,t.typeList.unshift({id:"",name:"全部"}),t.$storage.set("friendTypeList",t.typeList))}))},getImgInfo:function(e){return new Promise((function(n,i){t.getImageInfo({src:e,success:function(t){n({width:t.width,height:t.height})},fail:function(t){i(t)}})}))},getList:function(){var t=this;this.status="loading",this.$api.friendList(this.page).then((function(e){if(e.success){1==t.page.pageNo?(t.list=e.data.list,e.page.hasNextPage||(t.status="nomore")):(t.list=t.list.concat(e.data.list),e.page.hasNextPage||(t.status="nomore"));var n=t.list.map((function(e){return t.getImgInfo(e.picList[0])}));Promise.all(n).then((function(e){var n,i,o=360,a=588,u=12;for(var s in t.list)if(1==t.list[s].picList.length){var r=e[s],c=r.width/r.height;c<1/3?(n=o/3,i=o):1/3<=c&&c<=1?(n=o*c,i=o):1<=c&&c<=3?(n=o,i=o/c):3<c&&(n=a,i=(a-2*u)/3),t.$set(t.list[s],"width",n),t.$set(t.list[s],"height",i)}else n=(a-2*u)/3,i=(a-2*u)/3,t.$set(t.list[s],"width",n),t.$set(t.list[s],"height",i)})),console.log(t.list),t.status="loadmore"}}))},getExpandList:function(){var t=this;this.$api.expandList().then((function(e){e.success&&(console.log(e.data),t.expandList=e.data)}))},loadMore:function(){this.page.pageNo+=1,"nomore"!=this.status&&this.getList()},onReachBottom:function(){this.loadMore()}}};e.default=r}).call(this,n("543d")["default"])},ba54:function(t,e,n){},ef86:function(t,e,n){"use strict";n.r(e);var i=n("49dc"),o=n("4ae9");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("6e6a");var u,s=n("f0c5"),r=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"7216348e",null,!1,i["a"],u);e["default"]=r.exports}},[["7b64","common/runtime","common/vendor"]]]);